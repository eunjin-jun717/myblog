---
title: 기초 통계: 상관분석
date: 2021-04-05 15:08:52
tags: statistic
---
# 상관분석과 로지스틱회귀분석

## **상관분석**
### 개념(정의)
- 연속 변수로 측정된 두 변수간의 선형 관계를 분석하는 기법
- X가 증가함에 따라 B도 증가되는지 혹은 감소하는지를 분석
![](/hueman_images/statistics/cor1.png)
### 기본 가정사항
1) 두 변수 중 적어도 하나의 변수는 정규분포일 것
- 정규성 검사는 "shapiro.test()" 사용
- 만약, 두 변수 모두 정규성을 만족하지 못한다면?
- Spearman, Kendall 상관계수 사용!
- 정규성 검정에서 정규분포를 따르지 않거나 표본의 개수가 10개 미만일 때 사용

2) 연속형 두 변수 간에는 선형적인 관계가 있어야함
- 분석을 실시하기 전, 반드시 두 변수의 산점도를 통해 확인해야함

### 공분산(Corvariance)
- 2개의 확률 변수의 상관정도를 나타내는 값
- 만약 하나의 값이 상승하는 경향을 보이면서 다른 값도 상승하면, 이때 공분산의 값은 양수!
- 하나의 값이 상승하는데 반대로 다른 값은 하강하면, 이때 공분산 값은 음수!
- 공분산 값만으로는 상승 or 하강의 경향을 알 수는 있으나 어느정도의 상관관계인지는 파악할 수 없음
- 따라서 공분산을 표준화 시킨 "상관계수"를 통해 파악하자!

### 상관관계 & 상관계수(Correlation Coefficient)
1) 상관관계
- 두 변수의 선형적인 관계 정도를 나타냄
- 일반적으로, 피어슨 상관계수를 의미

2) 상관계수
- 피어슨 상관계수(Pearson)
![](/hueman_images/statistics/pearson.png)
![](/hueman_images/statistics/pearson2.png)
- 상관계수(r)의 값
: -1.0 <= r <= -0.7 (**강한 음적 선형관계**)\
  -0.7<= r <= -0.3 (**뚜렷한 음적 선형관계**)\
  -0.3<= r <= -0.1 (**약한 음적 선형관계**)\
  -0.1<= r <= +0.1 (**거의 무시될 수 있는 선형관계**)\
  +0.1<= r <= +0.3 (**약한 양적 선형관계**)\
  +0.3<= r <= +0.73 (**뚜렷한 양적 선형관계**)\
  +0.7<= r <= +1.0 (**강한 양적 선형관계**)
  
## **로지스틱 회귀분석**
### 로지스틱 회귀분석이 필요한 이유는?
### **GLM(Generalized Linear Model)**
- 비선형을 <span style="color:red">선형적</span>으로 일반화 시킨 모형
- <span style="color:red">이유는?</span> 선형모델에서만 사용할 수 있는 모형의 해석, 확장, 수정 등을 이용하기 위해!
- 선형화 시키는 대상은? 관심 범주에 속할 확률
![](/hueman_images/statistics/glm.png)
  
- 알코올 섭취량과 비만일 확률은 높아지지만 완전한 선형이라기 보다는 약간의 커브가 존재한다. 여기에 일반 선형회귀 라인을 넣으면 위와 같이 선형회귀선이 얼추 맞는다고 생각이 들 수 있다.
- 그렇지만 이 경우에는 음의 값이나 1을 초과하는 예측값을 제시할 수도 있는 가능성이 있다.
- 이러한 구조적 문제로 추가분석이 불가능하게 된다
- 그렇다면 비선형적인 모형을 넣어보면 어떨까?
![](/hueman_images/statistics/glm2.png)
  
- 훨씬 데이터에 잘 적용되는 것을 알 수 있다. 
- 그렇지만 비선형모델은 <span style="color:red">여러 가지 추가 분석 제약이 있다!</span>
- 따라서 이런 제약을 극복하기 위해 이를 선형화하는 것이 바로!! **로지스틱 회귀분석**!!
- 이러한 특징을 만족하는 함수가 **“시그모이드 함수”**이다.
![](/hueman_images/statistics/sigmoid.png)
  
- 시그모이드 함수(로지스틱 반응함수)를 Odds에 넣는다.
![](/hueman_images/statistics/odds.png)
- 확률p의 범위(0,1) -> Odds(p)의 범위는(0,∞) 이다.
  
- **Odds**가 클수록 데이터가 해당 집단에 속할 확률이 큼
- **Odds**에 **log**를 취하는데 이유는 선형으로 만들기 위해!
![](/hueman_images/statistics/logodds.png)
  
- 입력값(독립변수)의 범위가 –무한대에서 +무한대일 때,
- 출력값(종속변수)의 범위를 0에서 1로 변환시켜줌 
- X1, x2,…,xq가 어느 값을 가지더라도 항상 0과 1의 값을 가지게 된다.

**1) 정의: 분류모델(기법)**
- 일반적인 회귀분석과 동일하게 종속변수와 독립변수간의 관계를 함수로 나타내어 예측모델로 사용
- 특정기준(정답)에 의해 분석 대상을 특정개수의 집단으로 분류하는 **예측모형**
- 학습된 모델을 통해, 입력된 값을 미리 정해진 결과를 분류해주는 모델
- <span style="color:red">이항형</span> 로지스틱 회귀(Binary Logistic Regression): 2개의 범주\
Ex) 주택소유(있다/없다)
- <span style="color:red">다항형</span> 로지스틱 회귀(Multinomial Logistic Regression): 3개 이상의 범주\
Ex) 소유주택현황(아파트/단독주택/연립)
  
**2) Odds(승산비)**
- Odds란? 예측변수 1단위 변경 이후의 승산/ 원래 승산\
= 데이터가 어떤 집단에 속할 확률/ 속하지 않을 확률\
- 예를 들면, 나이의 Odds비가 0.969라면 나이가 한 단위 증가할수록 사망률이 0.969배 증가한다는 의미이다. 
- 다시 말해, 생존율이 0.041배 감소한다.

**3) 최대우도법 검정(Likelihood Ratio Test)**
- 일반적인 회귀분석과 다르게 최대우도법 검정으로 추정을 한다!!
- 선형 회귀분석: 최소제곱법
- 로지스틱 회귀분석: <span style="color:red">최대우도법</span>\
-> 원하는 값이 나올 확률을 최대로 만드는 모수를 선택하는 방법
- 즉, 주어진 현상이 있을 때, 이 현상이 추출될 가능성을 가장 높게한다.

**4) 이탈도(Deviance)**
- 모형의 적합도의 측도
- 두 모형의 로그가능도 함수 값의 차이가 유의한지 보는 것
![](/hueman_images/statistics/dev.png)
- 이때 포화모형이란 추정해야할 모수의 수가 데이터의 수와 동일한 상태
- 이탈도가 크면 그 모형은 적합하지 않다는 뜻
- 만약, p-value(>0.05)이 클 때 모형 M이 의미있다는 뜻

**5) AIC**
- 이탈도와 다르게 로그가능도 함수 값과 모형에 사용된 모수의 수를 동시에 고려
- 로그가능도함수 값이 높으면 가산점을 준다!\
  사용된 모수의 수가 많으면 패널티를 준다!\
  따라서 AIC가 작을수록 바람직한 모형
![](/hueman_images/statistics/aic.png)
- Ex) 2개의 모형 모수를 이용한 모형의 로그가능도함수 값(LL)이 -16,\
4개의 모수만을 이용한 모형의 로그가능도함수 값(LL)이 -15 일 때,\
각 모형의 AIC => 36, 38 이다.\
  비록 두번째 모형의 로그가능도함수 값이 -15로 더 컸지만,\
  모형에 사용된 모수의 개수가 첫번째 모형보다 2개가 더 사용되었기 때문에 바람직하지 않다고 볼 수 있다.
  
**6) 추가**
- *Residual deviance(잔차이탈도)* : 작을수록 좋고, 카이제곱분포를 따르기 때문에 카이제곱 적합도 검정을 통해 모형이 적합한지 확인가능
- *null deviance(0이탈도)* : 아무런 변수 없이 상수항만 있을 때의 이탈도
                       ,데이터가 전혀없는 최악의 상황
- *staturated model(포화모형)* : 추정해야할 모수의 수가 데이터의 수와 동일한 상태 즉, 데이터가 10000개이면 추정할 모수의 수도 10000개
- *Null model(영 모델)*: 절편항만 가지는 모형으로 추정할 모수가 1개임
- *Proposed Model(제안모형)*: p개의 모수+ 절편항을 포함하는 모형으로, 추정할 모수가 p+1 개임.

### 참조
1) [상관분석](https://m.blog.naver.com/PostView.nhn?blogId=y4769&logNo=220227007641&proxyReferer=https:%2F%2Fwww.google.com%2F)
2) [상관분석 R](https://kim-mj.tistory.com/56)
3) [로지스틱회귀](https://m.blog.naver.com/pmw9440/221894309623)
4) [이탈도](https://kmrho1103.tistory.com/entry/%EC%A0%9C2%EC%9E%A5-%ED%9A%8C%EA%B7%80%EB%AA%A8%ED%98%95-%EC%84%A0%ED%98%95%ED%9A%8C%EA%B7%80-%EB%A1%9C%EC%A7%80%EC%8A%A4%ED%8B%B1%ED%9A%8C%EA%B7%80)
5) [로그가능도, 이탈도](https://wikidocs.net/34040)